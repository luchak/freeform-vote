(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{178:function(e,t,n){e.exports=n(616)},183:function(e,t,n){},184:function(e,t,n){},616:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(176),i=n.n(l),o=(n(183),n(7)),u=(n(184),n(17)),s=n(18),c=n(115),m=n.n(c),v=n(91),d=n(618),f=m.a.mark(h);function h(e,t){var n,a;return m.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n=Math.min(e.length,t.length),a=0;case 2:if(!(a<n)){r.next=8;break}return r.next=5,[e[a],t[a]];case 5:++a,r.next=2;break;case 8:case"end":return r.stop()}},f)}function g(e){for(var t=(e=e.slice()).length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=e[t];e[t]=e[n],e[n]=a}return e}function y(e){return e.sort(function(e,t){return t.score-e.score})}function p(e){var t=[],n=(e=(e=(e=(e=e.trim()).replace("\r\n","\n")).replace(/\n[ \t\n]+\n/g,"\n\n")).replace(/[ \t]+/g," ")).split("\n\n"),a=!0,r=!1,l=void 0;try{for(var i,o=n[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var u=i.value,s=[],c=!0,m=!1,v=void 0;try{for(var d,f=u.split("\n")[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value,g=(h=h.trim()).split(" ");if(0===g.length)throw new Error("0 length rank group found");s.push(g)}}catch(y){m=!0,v=y}finally{try{c||null==f.return||f.return()}finally{if(m)throw v}}s.length>1?t.push(s):console.warn("Ignoring too-short ranking:",s)}}catch(y){r=!0,l=y}finally{try{a||null==o.return||o.return()}finally{if(r)throw l}}return t}function b(e,t,n){for(var a=new Map,r=0;r<n;++r){var l=new E,i=!0,u=!1,s=void 0;try{for(var c,m=g(e)[Symbol.iterator]();!(i=(c=m.next()).done);i=!0){var v=c.value;l.update(v)}}catch(d){u=!0,s=d}finally{try{i||null==m.return||m.return()}finally{if(u)throw s}}l.accumulateRatings(a)}return y(function(e,t,n){var a=[],r=!0,l=!1,i=void 0;try{for(var u,s=e.entries()[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=u.value,m=Object(o.a)(c,2),v=m[0],f=m[1],h=f.mu/n+t*Math.sqrt(f.sigma2/n);a.push({id:v,score:h})}}catch(d){l=!0,i=d}finally{try{r||null==s.return||s.return()}finally{if(l)throw i}}return a}(a,t,n))}var E=function(){function e(t,n){Object(u.a)(this,e),this._defaultMu=t,this._defaultSigma=n,this._ratings=void 0,this._ratings=new Map}return Object(s.a)(e,[{key:"accumulateRatings",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,l=this._ratings.entries()[Symbol.iterator]();!(t=(r=l.next()).done);t=!0){var i=r.value,u=Object(o.a)(i,2),s=u[0],c=u[1],m=e.get(s),v={mu:c.mu,sigma2:c.sigma*c.sigma};m&&(v.mu+=m.mu,v.sigma2+=m.sigma2),e.set(s,v)}}catch(d){n=!0,a=d}finally{try{t||null==l.return||l.return()}finally{if(n)throw a}}}},{key:"addEntry",value:function(e,t,n){var a=new v.a(t||this._defaultMu,n||this._defaultSigma);return this._ratings.set(e,a),a}},{key:"update",value:function(e){var t=this._rankingToRatingGroups(e),n=Object(d.a)(t);this._updateRatings(e,n)}},{key:"_rankingToRatingGroups",value:function(e){var t=[],n=!0,a=!1,r=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var o=l.value,u=[],s=!0,c=!1,m=void 0;try{for(var v,d=o[Symbol.iterator]();!(s=(v=d.next()).done);s=!0){var f=v.value,h=this._ratings.get(f);h||(h=this.addEntry(f)),u.push(h)}}catch(g){c=!0,m=g}finally{try{s||null==d.return||d.return()}finally{if(c)throw m}}t.push(u)}}catch(g){a=!0,r=g}finally{try{n||null==i.return||i.return()}finally{if(a)throw r}}return t}},{key:"_updateRatings",value:function(e,t){var n=!0,a=!1,r=void 0;try{for(var l,i=h(e,t)[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var u=l.value,s=Object(o.a)(u,2),c=s[0],m=s[1],v=!0,d=!1,f=void 0;try{for(var g,y=h(c,m)[Symbol.iterator]();!(v=(g=y.next()).done);v=!0){var p=g.value,b=Object(o.a)(p,2),E=b[0],w=b[1];this._ratings.set(E,w)}}catch(S){d=!0,f=S}finally{try{v||null==y.return||y.return()}finally{if(d)throw f}}}}catch(S){a=!0,r=S}finally{try{n||null==i.return||i.return()}finally{if(a)throw r}}}}]),e}(),w=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("b",null,"Optimism")," controls how much we credit (positive values) or penalize (negative values) entries with uncertain scores: controversial entries, or entries without many votes. Best to keep this zero or negative. (Details: controls how many standard deviations we should add/subtract from the mean of each entry's rating distribution to arrive at a final score.)"),r.a.createElement("div",null,r.a.createElement("b",null,"Samples"),' trades off computation time versus the stability of the final result. Use a low value for quick approximate answers, a higher value for more repeatable ones. (Details: the order in which we run "matches" affects the final result. This samples multiple orders and averages the results.)')),S=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("b",null,"Points by rank"),' is how many points entries get for each time they are listed at each rank, in descending order. So the default value of "3,2,1" means that first place gets 3 points, second gets 2, etc. Ties are split equally, so 2 entries tied for first/second with the default 3,2,1 scoring each get 2.5 points.')),k=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("b",null,"Points by rank"),' is how many points entries get for each time they are listed at each rank, in descending order. So the default value of "3,2,1" means that first place gets 3 points, second gets 2, etc. Ties are split equally, so 2 entries tied for first/second with the default 3,2,1 scoring each get 2.5 points.'),r.a.createElement("div",null,r.a.createElement("b",null,"Smoothing")," helps to stabilize (and reduce) the scores of mixes with a small number of rankings. If smoothing is 1, each mix is treated as though there were 1 extra ranking where it appeared rated too low to receive any points."));function x(e){for(var t=0,n=0,a=0;a<=0||a>=1;)a=(t=2*Math.random()-1)*t+(n=2*Math.random()-1)*n;var r=Math.sqrt(-2*Math.log(a)/a);return e.mu+Math.sqrt(e.sigma2)*n*r}function j(e){for(var t="";;){var n=e%26;if(e=Math.floor(e/26),t.length>0&&(n-=1),t=String.fromCharCode("A".charCodeAt(0)+n)+t,0===e)break}return t}function O(e,t){var n=[],a=!0,r=!1,l=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var u=i.value;if(Math.random()<u.pListen&&(n.push({id:u.id,score:x(u.quality)}),void 0!==t&&n.length>=t))break}}catch(s){r=!0,l=s}finally{try{a||null==o.return||o.return()}finally{if(r)throw l}}return y(n),console.log(n),n.map(function(e){return[e.id]})}var C=function(e){var t=Object(a.useState)(20..toString()),n=Object(o.a)(t,2),l=n[0],i=n[1],u=Object(a.useState)(.3.toString()),s=Object(o.a)(u,2),c=s[0],m=s[1],v=Object(a.useState)(.5.toString()),d=Object(o.a)(v,2),f=d[0],h=d[1],g=Object(a.useState)(.2.toString()),y=Object(o.a)(g,2),p=y[0],b=y[1],E=Object(a.useState)(10..toString()),w=Object(o.a)(E,2),S=w[0],k=w[1],C=Object(a.useState)(5..toString()),M=Object(o.a)(C,2),R=M[0],F=M[1];return r.a.createElement("form",{onSubmit:function(t){var n=parseFloat(f),a=(n-parseFloat(p))/2,r=function(e,t,n,a){for(var r=[],l=0;l<a;l++){for(var i=x(e),o={id:j(l),pListen:0,quality:{mu:i,sigma2:t*t}};o.pListen<=0||o.pListen>1;)o.pListen=x(n);r.push(o)}r.sort(function(e,t){return t.quality.mu-e.quality.mu});for(var u=0;u<r.length;u++)r[u].id=j(u);return r}({mu:0,sigma2:1},parseFloat(c),{mu:n,sigma2:a*a},parseInt(l,10));console.log("------------"),console.log(r);var i=function(e,t,n){for(var a=[],r=0;r<t;r++)a.push(O(e,n));return a}(r,parseInt(S,10),parseInt(R,10));console.log(i),e.setVotes(function(e){var t="",n=!0,a=!1,r=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var o=l.value,u=!0,s=!1,c=void 0;try{for(var m,v=o[Symbol.iterator]();!(u=(m=v.next()).done);u=!0)t+=m.value.join(" "),t+="\n"}catch(d){s=!0,c=d}finally{try{u||null==v.return||v.return()}finally{if(s)throw c}}t+="\n"}}catch(d){a=!0,r=d}finally{try{n||null==i.return||i.return()}finally{if(a)throw r}}return t}(i)),t.preventDefault()}},r.a.createElement("div",null,r.a.createElement("label",null,"Entry count:"),r.a.createElement("input",{type:"text",id:"numEntries",name:"numEntries",value:l,onChange:function(e){return i(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Taste deviation (< 1: mix quality determines score more than voter taste, > 1: voter taste determines score more than mix quality):"),r.a.createElement("input",{type:"text",id:"tasteStddev",name:"tasteStddev",value:c,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Mean listen probability"),r.a.createElement("input",{type:"text",id:"meanPListen",name:"meanPListen",value:f,onChange:function(e){return h(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Min listen probability"),r.a.createElement("input",{type:"text",id:"minPListen",name:"minPListen",value:p,onChange:function(e){return b(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Ranking count"),r.a.createElement("input",{type:"text",id:"numRankings",name:"numRankings",value:S,onChange:function(e){return k(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Max ranking length"),r.a.createElement("input",{type:"text",id:"maxRankingLength",name:"maxRankingLength",value:R,onChange:function(e){return F(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("input",{type:"submit"})))},M={averagePoints:{form:function(e){var t=Object(a.useState)("5,4,3,2,1".toString()),n=Object(o.a)(t,2),l=n[0],i=n[1],u=Object(a.useState)(1..toString()),s=Object(o.a)(u,2),c=s[0],m=s[1];return r.a.createElement("form",{onSubmit:function(t){var n=l.split(",").map(function(e){return parseInt(e.trim(),10)}),a=function(e,t,n){var a=new Map,r=new Map,l=!0,i=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(l=(s=c.next()).done);l=!0){var m=s.value,v=0,d=!0,f=!1,h=void 0;try{for(var g,p=m[Symbol.iterator]();!(d=(g=p.next()).done);d=!0){for(var b=g.value,E=0,w=0;w<b.length;w++)E+=t[v++]||0;var S=E/b.length,k=!0,x=!1,j=void 0;try{for(var O,C=b[Symbol.iterator]();!(k=(O=C.next()).done);k=!0){var M=O.value,R=a.get(M)||0,F=r.get(M)||n;R+=S,F+=1,a.set(M,R),r.set(M,F)}}catch(z){x=!0,j=z}finally{try{k||null==C.return||C.return()}finally{if(x)throw j}}}}catch(z){f=!0,h=z}finally{try{d||null==p.return||p.return()}finally{if(f)throw h}}}}catch(z){i=!0,u=z}finally{try{l||null==c.return||c.return()}finally{if(i)throw u}}var P=[],_=!0,q=!1,B=void 0;try{for(var L,T=a.entries()[Symbol.iterator]();!(_=(L=T.next()).done);_=!0){var A=L.value,I=Object(o.a)(A,2),V=I[0],D=I[1];P.push({id:V,score:D/r.get(V)})}}catch(z){q=!0,B=z}finally{try{_||null==T.return||T.return()}finally{if(q)throw B}}return y(P)}(p(e.votes),n,parseFloat(c));e.setResult(a.map(function(e,t){return"".concat(t+1,"\t").concat(e.score.toFixed(3),"\t").concat(e.id)}).join("\n")),t.preventDefault()}},r.a.createElement("div",null,r.a.createElement("label",null,"Points by rank:"),r.a.createElement("input",{type:"text",id:"rankPoints",name:"rankPoints",value:l,onChange:function(e){return i(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Smoothing:"),r.a.createElement("input",{type:"text",id:"smoothing",name:"smoothing",value:c,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Votes:")),r.a.createElement("div",null,r.a.createElement("textarea",{id:"votes",name:"votes",rows:30,cols:60,value:e.votes,onChange:function(t){return e.setVotes(t.target.value)}})),r.a.createElement("div",null,r.a.createElement("input",{type:"submit"})))},instructions:k},points:{form:function(e){var t=Object(a.useState)("5,4,3,2,1".toString()),n=Object(o.a)(t,2),l=n[0],i=n[1];return r.a.createElement("form",{onSubmit:function(t){var n=l.split(",").map(function(e){return parseFloat(e.trim())}),a=function(e,t){var n=new Map,a=!0,r=!1,l=void 0;try{for(var i,u=e[Symbol.iterator]();!(a=(i=u.next()).done);a=!0){var s=i.value,c=0,m=!0,v=!1,d=void 0;try{for(var f,h=s[Symbol.iterator]();!(m=(f=h.next()).done);m=!0){for(var g=f.value,p=0,b=0;b<g.length;b++)p+=t[c++]||0;var E=p/g.length,w=!0,S=!1,k=void 0;try{for(var x,j=g[Symbol.iterator]();!(w=(x=j.next()).done);w=!0){var O=x.value,C=n.get(O)||0;C+=E,n.set(O,C)}}catch(I){S=!0,k=I}finally{try{w||null==j.return||j.return()}finally{if(S)throw k}}}}catch(I){v=!0,d=I}finally{try{m||null==h.return||h.return()}finally{if(v)throw d}}}}catch(I){r=!0,l=I}finally{try{a||null==u.return||u.return()}finally{if(r)throw l}}var M=[],R=!0,F=!1,P=void 0;try{for(var _,q=n.entries()[Symbol.iterator]();!(R=(_=q.next()).done);R=!0){var B=_.value,L=Object(o.a)(B,2),T=L[0],A=L[1];M.push({id:T,score:A})}}catch(I){F=!0,P=I}finally{try{R||null==q.return||q.return()}finally{if(F)throw P}}return y(M)}(p(e.votes),n);e.setResult(a.map(function(e,t){return"".concat(t+1,"\t").concat(e.score.toFixed(3),"\t").concat(e.id)}).join("\n")),t.preventDefault()}},r.a.createElement("div",null,r.a.createElement("label",null,"Points by rank:"),r.a.createElement("input",{type:"text",id:"rankPoints",name:"rankPoints",value:l,onChange:function(e){return i(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Votes:")),r.a.createElement("div",null,r.a.createElement("textarea",{id:"votes",name:"votes",rows:30,cols:60,value:e.votes,onChange:function(t){return e.setVotes(t.target.value)}})),r.a.createElement("div",null,r.a.createElement("input",{type:"submit"})))},instructions:S},trueSkill:{form:function(e){var t=Object(a.useState)((-3).toString()),n=Object(o.a)(t,2),l=n[0],i=n[1],u=Object(a.useState)(100..toString()),s=Object(o.a)(u,2),c=s[0],m=s[1];return r.a.createElement("form",{onSubmit:function(t){var n=b(p(e.votes),parseFloat(l),parseInt(c,10));e.setResult(n.map(function(e,t){return"".concat(t+1,"\t").concat(e.score.toFixed(3),"\t").concat(e.id)}).join("\n")),t.preventDefault()}},r.a.createElement("div",null,r.a.createElement("label",null,"Optimism (-3 to -2 seems ideal):"),r.a.createElement("input",{type:"text",id:"optimism",name:"optimism",value:l,onChange:function(e){return i(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Samples (1 to 10000):"),r.a.createElement("input",{type:"number",id:"epochs",name:"epochs",min:"1",max:"10000",value:c,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"Votes:")),r.a.createElement("div",null,r.a.createElement("textarea",{id:"votes",name:"votes",rows:30,cols:60,value:e.votes,onChange:function(t){return e.setVotes(t.target.value)}})),r.a.createElement("div",null,r.a.createElement("input",{type:"submit"})))},instructions:w}},R=function(){var e=Object(a.useState)("Asiago Brie\nCheddar\n\nBrie Cheddar\nAsiago\n\nAsiago\nBrie\n\nCheddar\nAsiago\nDanishBlue\n\nBrie\nAsiago\nCheddar\n\nBrie\nDanishBlue\nAsiago\nCheddar\n\n"),t=Object(o.a)(e,2),n=t[0],l=t[1],i=Object(a.useState)(null),u=Object(o.a)(i,2),s=u[0],c=u[1],m=Object(a.useState)("trueSkill"),v=Object(o.a)(m,2),d=v[0],f=v[1],h=M[d],g=h.form,y=h.instructions;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"Provide rankings, get scores!"),r.a.createElement("div",null,"\xa0"),r.a.createElement("div",null,"This page demonstrates using"," ",r.a.createElement("a",{href:"https://trueskill.org/"},"TrueSkill")," to construct a voting system where not every voter has to evaluate every entry. Each voter instead ranks every entry they have an opinion about. We can get scores (and therefore a consensus ranking) from these inputs by treating each voter's ranking as the result of a free-for-all match between all the entries they ranked, and use TrueSkill to update entry ratings based on the results of each match."),r.a.createElement("div",null,r.a.createElement("h3",null,"Instructions")),r.a.createElement("div",null,r.a.createElement("b",null,"Votes:")," each block of lines below is an individual voter's ranking. Entries that come first are ranked higher, entries appearing on the same line are ties. For example: in the default rankings in the box below, the first user has ranked Asiago and Brie tied for first, with Cheddar coming in second. The second user ranked Brie and Cheddar first, and Asiago second."),y,r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"50% 50%"}},r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h3",null,"Inputs")),r.a.createElement("div",null,r.a.createElement("label",null,"Mode:"),r.a.createElement("select",{value:d,onChange:function(e){return f(e.target.value)}},Object.keys(M).map(function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement("div",null,r.a.createElement(g,{votes:n,setVotes:l,setResult:c}))),r.a.createElement("div",null,r.a.createElement("h3",null,"Results"),s&&r.a.createElement("pre",null,s))),r.a.createElement("h3",null,"Simulate voting"),r.a.createElement(C,{setVotes:l}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[178,1,2]]]);
//# sourceMappingURL=main.4a46427c.chunk.js.map